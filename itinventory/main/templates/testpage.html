{% load static %}
<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<meta name="description" content="Responsive Admin &amp; Dashboard Template based on Bootstrap 5">
	<meta name="author" content="AdminKit">
	<meta name="keywords" content="adminkit, bootstrap, bootstrap 5, admin, dashboard, template, responsive, css, sass, html, theme, front-end, ui kit, web">

	<link rel="preconnect" href="https://fonts.gstatic.com">
	<link rel="shortcut icon" href="{% static 'img/icons/icon-48x48.png' %}" />

	<link rel="canonical" href="https://demo-basic.adminkit.io/pages-blank.html" />

	<title>IT Inventory System</title>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

	<link href="{% static 'css/app.css' %}" rel="stylesheet">
    <link href="{% static 'css/modalform.css' %}" rel="stylesheet">
	<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&display=swap" rel="stylesheet">
	<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.es.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
	<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&display=swap" rel="stylesheet">
</head>

<body>
	<div style="display: none;">
	<input type="text" name="navstate" id="navstate"></div>
	<div class="wrapper">
		<nav id="sidebar" class="sidebar " >
			<div class="sidebar-content js-simplebar">
				<a class="sidebar-brand" href="{% url 'dashboard' %}">
					<span class="align-middle">IT Inventory System</span>
				</a>
				<div style="{{Style}}"> 
				<li class="sidebar-header">
					Administrator Page
				</li>
		
			<li class="sidebar-item">
				<a class="sidebar-link" href="{% url 'admin:index' %}">
	  <i class="align-middle" data-feather="sliders"></i> <span class="align-middle">Go to Admin </span>
	</a>
			</li>
		</div>
		<li class="sidebar-header">
			Loan
		</li>


		<li class="sidebar-item">
			<a class="sidebar-link" href="{% url 'loanpage' %}">
  <i class="align-middle" data-feather="sliders"></i> <span class="align-middle">Loan Detail</span>
</a>
		</li>
		
		
						<li class="sidebar-header">
								Computer
							</li>
		
							<li class="sidebar-item">
								<a class="sidebar-link" href="{% url 'computerpage' %}">
					  <i class="align-middle" data-feather="sliders"></i> <span class="align-middle">Computer Details</span>
					</a>
							</li>
		
				
		
						
							<li class="sidebar-header">
								Laptop
							</li>
		
							<li class="sidebar-item">
								<a class="sidebar-link" href="{% url 'laptoppage' %}">
					  <i class="align-middle" data-feather="sliders"></i> <span class="align-middle">Laptop Detail</span>
					</a>
							</li>
		
				
		
					
							<li class="sidebar-header">
								Other
							</li>
		
							<li class="sidebar-item">
								<a class="sidebar-link" href="{% url 'Networkhardwarepage' %}">
					  <i class="align-middle" data-feather="sliders"></i> <span class="align-middle">Network Hardware Detail</span>
					</a>
							</li>
		
							<li class="sidebar-header">
								IP
							</li>
		
							<li class="sidebar-item">
								<a class="sidebar-link" href="{% url 'ippage' %}">
					  <i class="align-middle" data-feather="sliders"></i> <span class="align-middle">IP Detail</span>
					</a>
							</li>
		
							
							<li class="sidebar-header">
								User
							</li>
		
							<li class="sidebar-item">
								<a class="sidebar-link" href="{% url 'userpage' %}">
					  <i class="align-middle" data-feather="sliders"></i> <span class="align-middle">User Detail</span>
					</a>
							</li>
							
							<li class="sidebar-header">
								software
							</li>
			
		
							<li class="sidebar-item">
								<a class="sidebar-link" href="{% url 'software' %}">
					  <i class="align-middle" data-feather="sliders"></i> <span class="align-middle">software User</span>
					</a>
							</li>
							<div style="{{Style}}">
								<li class="sidebar-header">
									Upload Page
								</li>
						
							<li class="sidebar-item">
								<a class="sidebar-link" href="{% url 'uploadcsvdata' %}">
					  <i class="align-middle" data-feather="sliders"></i> <span class="align-middle">Upload Page </span>
					</a>
							</li>
						</div>
			
		
		
					
					</div>
				</nav>

		<div class="main">
			<nav class="navbar navbar-expand navbar-light navbar-bg">
				<a class="sidebar-toggle -toggle">
          <i class="hamburger align-self-center"></i>
        </a>

				<div class="navbar-collapse collapse">
					<ul class="navbar-nav navbar-align">
					
						<li class="nav-item dropdown">
							<a class="nav-icon dropdown-toggle d-inline-block d-sm-none" href="#" data-bs-toggle="dropdown">
                <i class="align-middle" data-feather="settings"></i>
              </a>

							<a class="nav-link dropdown-toggle d-none d-sm-inline-block" href="#" data-bs-toggle="dropdown">
                 <span class="text-dark">{{Username}}</span>
              </a>
							<div class="dropdown-menu dropdown-menu-end">
								<div style="{{Style}}">
								<a class="dropdown-item" href="{% url 'historypage' %}"><i class="align-middle me-1" data-feather="user"></i> History</a>
							</div>
								
								<div class="dropdown-divider"></div>
								<a class="dropdown-item" href="{% url 'logoutsystem' %}">Log out</a>
							</div>
						</li>
					</ul>
				</div>
			</nav>

			<main class="content">
                {% csrf_token %}
				<div class="container-fluid p-0">

					<h1 class="h3 mb-3"></h1>

					<div class="row">
						<div class="col-12">
							<div class="card">
								<div class="card-header">
									<h5 class="card-title mb-0">Dashboard</h5>
								</div>
								<div class="card-body">
									<div class="card" >
										<h5 class="card-title text-dark">Computer Details</h5>
										
										<div class="card-body">
											<div class="card-body">
												<div class="d-flex justify-content-around">
													<div class="card" style="width: 30rem;">
														<h5 class="card-title text-dark">Type of Windows in Computer Details</h5>
														<div class="card-body">
															<canvas id="myChart"></canvas>
														</div>
													  </div>
													  <div class="card" style="width: 30rem;">
														<h5 class="card-title text-dark">Usage of PC in Computer Details</h5>
														<div class="card-body">
															<canvas id="pc"></canvas>
														</div>
													  </div> 
												</div>
												<br>
												<div class="d-flex justify-content-around">
													<div class="card" style="width: 30rem;">
														<h5 class="card-title text-dark">Type of PC in Computer Details</h5>
														<div class="card-body">
															<canvas id="pctype"></canvas>
														</div>
													  </div>
													  <div class="card" style="width: 30rem;">
														<h5 class="card-title text-dark">Type of PC Connection in Computer Details</h5>
														<div class="card-body">
															<canvas id="conPC"></canvas>
														</div>
													  </div> 
												</div>
												<div class="d-flex justify-content-around">
													<div class="card" style="width: 30rem;">
														<h5 class="card-title text-dark">Percentage of USB Block in Computer Details</h5>
														<div class="card-body">
															<canvas id="USBPC"></canvas>
														</div>
													  </div>
													  <div class="card" style="width: 30rem;">
														<h5 class="card-title text-dark">Percentage of CD Block in Computer Details</h5>
														<div class="card-body">
															<canvas id="CDPC"></canvas>
														</div>
													  </div> 
												</div>
												
												
											</div>
											
										</div>
									  </div>
									  <br>
									  <div class="card" >
										<h5 class="card-title text-dark">Laptop Details</h5>
										<div class="card-body">
											<div class="card-body">
												<div class="d-flex justify-content-around">
													<div class="card" style="width: 30rem;">
														<h5 class="card-title text-dark">Type of Windows in Laptop Details</h5>
														<div class="card-body">
															<canvas id="windowlaptop"></canvas>
														</div>
													  </div>
													  <div class="card" style="width: 30rem;">
														<h5 class="card-title text-dark">Usage of PC in Laptop Details</h5>
														<div class="card-body">
															<canvas id="usagelaptop"></canvas>
														</div>
													  </div> 
												</div>
												<br>
												<div class="d-flex justify-content-around">
												
													  <div class="card" style="width: 30rem;">
														<h5 class="card-title text-dark">Type of PC Connection in Laptop Details</h5>
														<div class="card-body">
															<canvas id="conLpatop"></canvas>
														</div>
													  </div> 

													  <div class="card" style="width: 30rem;">
														<h5 class="card-title text-dark">Percentage of USB Block in Laptop Details</h5>
														<div class="card-body">
															<canvas id="USBLaptop"></canvas>
														</div>
													  </div> 
												</div>
												
												<div class="d-flex justify-content-around">
												
										
													<div class="card" style="width: 30rem;">
													  <h5 class="card-title text-dark">Percentage of CD Block in Laptop Details</h5>
													  <div class="card-body">
														  <canvas id="CDLaptop"></canvas>
													  </div>
													</div> 
											  </div>
												
											</div>
											
										</div>
									  </div>
									  
									
								</div>
							</div>
						</div>
					</div>

				</div>
			</main>

			<footer class="footer">
			
			</footer>
		</div>
	</div>
	
<div id="exportdata" class="modalform">

        <!-- Modal content -->
        <div class="modalform-header">
          <span onclick="closeexportdata()" class="closeform">&times;</span>
         <h1 class="text-center">Export data</h1>
        </div>
        <div class="modalform-content">
          
                {% csrf_token %}
                   
                <h3 class="text-center" style=" color: #564953;"> data  Details</h3>
                <div>

                <br>
                <br>
                
                <br>
                <div class="table-responsive " style="height: 400px;">
                    <table class="table" id="computertable">
                        <thead class="table-dark" id="computer-list">
                          <tr id="TRexport">
                            
                            <th scope="col">Computer ID</th>
                            <th scope="col">Current Computer ID</th>
                            <th scope="col">PC Type</th>
                            <th scope="col">PIC</th>
                            <th scope="col">Previous PIC</th>
                            
                            <th scope="col">Brand</th>
                            <th scope="col">Model</th>
                            <th scope="col">S/N</th>
                            <th scope="col">Asset No</th>
                            <th scope="col">DOP</th>
                            <th scope="col">DOP (Years) / Warranty-end-date</th>
                            <th scope="col">Vendor</th>
                            <th scope="col">PO</th>
                            <th scope="col">Invoice</th>
                            <th scope="col">Type of Purchase</th>
                            <th scope="col">Block</th>
                            <th scope="col">Location</th>
    
                            <th scope="col">Standard Installation</th>
                            <th scope="col">USB Unlock</th>
                            <th scope="col">CD Unlock</th>
                            <th scope="col">OS</th>
                            <th scope="col">Office Version</th>
                            <th scope="col">Office Product Key</th>
                            <th scope="col">Processor Type</th>
                            <th scope="col">RAM Type</th>
                            <th scope="col">RAM Slot</th>
                            <th scope="col">Total RAM</th>
                            <th scope="col">Type of Storage</th>
                            <th scope="col">Total Storage Value</th>
                            <th scope="col">Connection Type</th>
                            <th scope="col">Joined Domain</th>
                            <th scope="col">Lan NIC MAC</th>
                            <th scope="col">Lan IP Address</th>
                            <th scope="col">Wlan NIC MAC</th>
                            <th scope="col">Wlan IP Address</th>
                            <th scope="col">PC Status</th>
                            
    
    
                            
                            
    
                            
                          </tr>
                        </thead>
                        
                        <tbody id="exportdataTD">
                        
                        
    
                        
                          
                        </tbody>
                      </table>
                    </div>
                 
        </div>
        <div class="modalform-footer">
            
        </div>
      
      </div>
<script src="{% static 'js/app.js' %}"></script>
<script>
$(document).ready(function() {
		// computer detail
		setInterval(computer_graph_Window(), 1000);
		setInterval(laptop_graph_Window(), 1000);
		// setInterval(imagedata(), 1000);
		// setInterval(displayHello, 1000);
		// setInterval(displayHello, 1000);
		// setInterval(displayHello, 1000);
		// setInterval(displayHello, 1000);
	});

function clickNav(){
	var state = document.getElementById("navstate").value;
	if(state == "True"){
		closenavbar()
	}
	else{
		opennavbar()
	}
}
function opennavbar(){
	document.getElementById("main").style.marginLeft = "25%";
  document.getElementById("sidebar").style.width = "25%";
  document.getElementById("sidebar").style.display = "block";
  document.getElementById("navstate").value = "False";
  
}

function closenavbar(){
  document.getElementById("main").style.marginLeft = "0%";

  document.getElementById("sidebar").style.display = "none";
  document.getElementById("openNav").style.display = "inline-block";
  document.getElementById("navstate").value = "True";

  
}

	// Computer Details
function computer_graph_Window(){
	$.ajax({
			type: 'Get',
			cache: false,
			url: "{% url 'getcomputerdata' %}",
		
			success: function(response){
				// data type for the graph
				var officepc = [];
				var machinepc = [];
				var Window_98 = [];
				var Window_10 = [];
				var Window_7 = [];
				var Window_xp = [];
				var Window_8 = [];
				var con_intranet = [];
				var con_internet = [];
				var con_offline = [];
				var status_not_inuse = [];
				var status_inuse = [];
				var status_dispose = [];
				var status_pending_dispose = [];
				var status_loan = [];
				// data for the data type
				var data_status = [];
				var data_window = [];
				var data_type = [];
				var data_typeCon = [];

				var data_CD = [];
				var data_USB = [];

				var data_USB_Y = [];
				var data_USB_N = [];

				var data_CD_Y = [];
				var data_CD_N = [];
				var data_USAGEPC = [];
				var PCFree = [];
				var PCNotfree = [];

				for (var item in response.data){
					data_status.push(response.data[item].pccurrentstatus);
					data_window.push(response.data[item].windows);
					data_type.push(response.data[item].pctype);
					data_typeCon.push(response.data[item].connection_type);
					data_USB.push(response.data[item].usbunlock);
					data_CD.push(response.data[item].cdunlock);
					datax = [response.data[item].pccurrentstatus, response.data[item].pic ]
					data_USAGEPC.push(datax);



				}
				officepc = data_type.filter(function(item) {
			
				return item == 'Office PC';
				});
				machinepc = data_type.filter(function(item) {
			
				return item == 'PC Machine' ;
				});
				Window_98 = data_window.filter(function(item) {
			
			return item == 'Windows 98';
			});
			Window_95 = data_window.filter(function(item) {
		
		return item == 'Windows 95';
		});
			var Window_2000 = data_window.filter(function(item) {
			
			return item == 'Windows 2000 Professional';
			});
			var Window_8 = data_window.filter(function(item) {
			
			return item == 'Windows 8.1 Pro 32bit';
			});
			var Window_nt = data_window.filter(function(item) {
			
			return item == 'Windows NT4 workstation';
			});
			Window_10 = data_window.filter(function(item) {
		
			return item == 'Windows 10 Pro 64bit' || item == 'Windows 10 Pro' || item == 'Windows 10 Enterprise LTSC' || item == 'Windows 10 PRo'  || item == 'Windows 10 Iot Ent2019' ;
			});
			Window_7 = data_window.filter(function(item) {
		
			return item == 'Windows 7 Ultimate' || item == 'Windows 7 Pro 32bit' || item == 'Windows 7 Pro 64bit';
			});
			Window_xp = data_window.filter(function(item) {
			
			return item == 'Windows XP Pro 32bit' || item == 'Windows Vista' ;
			});
			
			status_dispose = data_status.filter(function(item) {
			
			return item == 'Dispose'  ;
			});
			status_pending_dispose = data_status.filter(function(item) {
			
			return item == 'Pending Dispose'  ;
			});
			status_inuse = data_status.filter(function(item) {
			
			return item == 'In-use'  || item == 'In-Use';
			});
			status_not_inuse = data_status.filter(function(item) {
			
			return item == 'Not in-use'  ;
			});
		
			status_loan = data_status.filter(function(item) {
			
			return item == 'Loan' ||  item == 'loan' ;
			});
			
			con_intranet = data_typeCon.filter(function(item) {
			
			return item == 'Intranet'  ;
			});
			con_internet = data_typeCon.filter(function(item) {
			
			return item == 'Internet' || item == 'Online' ;
			});
			con_offline = data_typeCon.filter(function(item) {
			
			return item == 'Offline'  ;
			});

			YesUSb = data_USB.filter(function(item) {
			
			return item == 'Yes';
			});

			NoUsb = data_USB.filter(function(item) {
			
			return item == 'No';
			});

			YesCD = data_CD.filter(function(item) {
			
			return item == 'Yes';
			});

			NoCD = data_CD.filter(function(item) {
			
			return item == 'No';
			});

		
			PCFreeStatusV1 = data_USAGEPC.filter(function(item) {
			
			return item[0] != 'In-use' && item[1]== "None" || item[1]== "None";
			});
			PCFreeStatusloan = PCFreeStatusV1.filter(function(item) {
			
			return item[0] == 'Loan' || item[0] == 'loan';
			});
			PCFreeStatusNotinuse = PCFreeStatusV1.filter(function(item) {
			
			return item[0] == 'Not in-use' || item[0] == 'not in-use';
			});
			PCFreeStatusinuse = PCFreeStatusV1.filter(function(item) {
			
			return item[0]  == 'In-use'  || item[0]  == 'In-Use';
			});
			

		


	

			computer_detail_graph_window(Window_98,Window_95, Window_2000, Window_nt, Window_xp,Window_7,Window_8,Window_10);
		
				computer_detail_graph_usage(status_not_inuse, status_inuse, status_pending_dispose, status_dispose, status_loan);
				computer_detail_graph_pctype(officepc, machinepc);
				computer_detail_graph_connection(con_internet, con_intranet, con_offline);
				computer_detail_graph_USB(YesUSb, NoUsb);
				computer_detail_graph_CD(YesCD, NoCD);

				
			}
		});

}
function computer_detail_graph_window(array1, array2, array3, array4, array5, array6, array7, array8){
	var w98 = array1.length;
	var w95 = array2.length;
	var w2000 = array3.length;
	var wNT = array4.length;
	var wXP = array5.length;
	var w7 = array6.length;
	var w8 = array7.length;
	var w10 = array8.length;

	const data = {
  labels: [
  'Window 98',
  'Window 95',
  'Window 2000',
  'Window NT',

    'Window xp',
    'Windows 7',
	'Window 8',

    'Windows 10',
	


  ],
  datasets: [{
    label: 'Type of windows in Computer Details',
    data: [w98, w95, w2000, wNT, wXP, w7, w8, w10],
    backgroundColor: [
      'rgb(255, 99, 132)',
      'rgb(54, 162, 235)',
      'rgb(255, 205, 86)',
      'rgb(137, 109, 93)',
	  'rgb(255, 86, 0)',
      'rgb(255, 86, 143)',
      'rgb(184, 86, 143)',
      'rgb(184, 86, 247)',

    ],
    hoverOffset: 4
  }]
};
const config = {
  type: 'pie',
  data: data,
};
const myChart = new Chart(
    document.getElementById('myChart'),
    config
  );
}

function computer_detail_graph_usage(array1, array2, array3, array4, array5){

	var not_use = array1.length;
	var use = array2.length;
	var pending = array3.length;
	var dispose = array4.length;
	var loan = array5.length;



	const data = {
  labels: [
  'Not In-Use',
    'In-use',
    'Loan',
    'Pending Dispose',
    'Dispose',



  ],
  datasets: [{
    label: 'Usage of PC in Computer Details',
    data: [not_use, use, loan, pending, dispose],
    backgroundColor: [
      'rgb(169, 186, 180)',
      'rgb(76, 212, 166)',
      'rgb(236, 242, 46)',
      'rgb(224, 64, 20)',
      'rgb(247, 2, 2)',


    ],
    hoverOffset: 4
  }]
};

const config = {
  type: 'pie',
  data: data,
  options: {
      scales: {
        yAxes: [{
            ticks: {
                beginAtZero:true
            }
        }]
    },
onClick:function(e){
    var activePoints = myChart.getElementsAtEvent(e);
    var selectedIndex = activePoints[0]._index;
    console.log(selectedIndex);
    if (selectedIndex == 0){
        var type = "Not-inuse";
        displayusagePC(type)
      

        

    }
    else if (selectedIndex == 1){

    }
    else if (selectedIndex == 2){

    }
    else if (selectedIndex == 3){

    }
    else if (selectedIndex == 4){

    }
   
}
}
};

const myChart = new Chart(
    document.getElementById('pc'),
    config
  );

}


function computer_detail_graph_pctype(array1, array2){
	var office = array1.length;
	var machine = array2.length;


	const data = {
  labels: [
  'Office PC',
    'Machine PC',
   


  ],
  datasets: [{
    label: 'Type of PC in Computer Details',
    data: [office, machine],
    backgroundColor: [
      'rgb(255, 99, 132)',
      'rgb(54, 162, 235)',
    

    ],
    hoverOffset: 4
  }]
};
const config = {
  type: 'pie',
  data: data,
};
const myChart = new Chart(
    document.getElementById('pctype'),
    config
  );
}

function computer_detail_graph_connection(array1, array2, array3){
	var Internet = array1.length;
	var Intranet = array2.length;
	var Offline = array3.length;




	const data = {
  labels: [
  'Internet',
    'Intranet',
    'Offline'



  ],
  datasets: [{
    label: 'Type of connection in Computer Details',
    data: [Internet, Intranet, Offline],
    backgroundColor: [
      'rgb(255, 99, 132)',
      'rgb(54, 162, 235)',
      'rgb(255, 205, 86)'
      

    ],
    hoverOffset: 4
  }]
};
const config = {
  type: 'pie',
  data: data,
};
const myChart = new Chart(
    document.getElementById('conPC'),
    config
  );
}

function computer_detail_graph_USB(array1, array2){
	var data1 = array1.length;
	var data2 = array2.length;





	const data = {
  labels: [
  'Unlock',
    'Block',
  



  ],
  datasets: [{
    label: 'Percentage of USB Block in Computer Details',
    data: [data1, data2],
    backgroundColor: [
	'rgb(46, 199, 87)',
      'rgb(255, 99, 132)'
      
      

    ],
    hoverOffset: 4
  }]
};
const config = {
  type: 'pie',
  data: data,
};
const myChart = new Chart(
    document.getElementById('USBPC'),
    config
  );
}

function computer_detail_graph_CD(array1, array2){
	var data1 = array1.length;
	var data2 = array2.length;




	const data = {
  labels: [
  'Unlock',
    'Block'



  ],
  datasets: [{
    label: 'Percentage of CD Block in Computer Details',
    data: [data1, data2],
    backgroundColor: [
	'rgb(46, 199, 87)',
      'rgb(255, 99, 132)'

    ],
    hoverOffset: 4
  }]
};
const config = {
  type: 'pie',
  data: data,
};
const myChart = new Chart(
    document.getElementById('CDPC'),
    config
  );
}

function displayusagePC (type){
    const csrftoken = document.querySelector('[name=csrfmiddlewaretoken]').value;
    console.log("function get run");
    $.ajax({
            type: 'POST',
			headers: {'X-CSRFToken': csrftoken},
			mode: 'same-origin', // Do not send CSRF token to another domain.
			url: "{% url 'usagepcpie' %}",
			data : {'type': type}, 
		
			success: function(response){
               
                var modalform = document.getElementById('exportdata');
		        modalform.style.display = 'block';
				console.log(response)
				$(exportdataTD).empty();
				var indexarray = 0
				for (var item in response.data){
					var tr = document.createElement("tr");
						var td1 = document.createElement("td");
						td1.innerHTML =response.data[item].computer_id;
						var td2 = document.createElement("td");
						td2.innerHTML =response.data[item].current_computer_id;
						var td3 = document.createElement("td");
						td3.innerHTML =response.data[item].pic;
						var td4 = document.createElement("td");
						td4.innerHTML =response.data[item].previous_pic;
						var td5 = document.createElement("td");
						td5.innerHTML =response.data[item].pccurrentstatus;
						var td6 = document.createElement("td");
						td6.innerHTML =response.data[item].pctype;
						var td7 = document.createElement("td");
						td7.innerHTML =response.data[item].Brand;
						var td8 = document.createElement("td");
						td8.innerHTML =response.data[item].Model;
						var td9 = document.createElement("td");
						td9.innerHTML =response.data[item].windows;
						var td10 = document.createElement("td");
						td10.innerHTML =response.data[item].serial_number;
						
						var td11 = document.createElement("td");
						td11.innerHTML =response.data[item].asset_no;
						var td12 = document.createElement("td");
						td12.innerHTML =response.data[item].block;
						var td13 = document.createElement("td");
						td13.innerHTML =response.data[item].location;
						var td14 = document.createElement("td");
						td14.innerHTML =response.data[item].standard_installation;
						var td36 = document.createElement("td");
						td36.innerHTML =response.data[item].usbunlock;
						var td37 = document.createElement("td");
						td37.innerHTML =response.data[item].cdunlock;
						var td15 = document.createElement("td");
						td15.innerHTML =response.data[item].microsoft_office;
						var td16 = document.createElement("td");
						td16.innerHTML =response.data[item].microsoft_office_keys;
						var td17 = document.createElement("td");
						td17.innerHTML =response.data[item].dop;
						var td18 = document.createElement("td");
						td18.innerHTML =response.data[item].dop_Warranty_end_date;
						var td19 = document.createElement("td");
						td19.innerHTML =response.data[item].po;
						var td20 = document.createElement("td");
						td20.innerHTML =response.data[item].invoice;
						var td21 = document.createElement("td");
						td21.innerHTML =response.data[item].vendor;
						var td22 = document.createElement("td");
						td22.innerHTML =response.data[item].processor_type;
						var td23 = document.createElement("td");
						td23.innerHTML =response.data[item].ram_type;
						var td24 = document.createElement("td");
						td24.innerHTML =response.data[item].ram_slot;
						var td25 = document.createElement("td");
						td25.innerHTML =response.data[item].total_ram;
						var td26 = document.createElement("td");
						td26.innerHTML =response.data[item].storage_type;
						var td27 = document.createElement("td");
						td27.innerHTML =response.data[item].storage_space;
						var td28 = document.createElement("td");
						td28.innerHTML =response.data[item].lan_mac_address;
						var td29 = document.createElement("td");
						td29.innerHTML =response.data[item].lan_ip_address;
						var td30 = document.createElement("td");
						td30.innerHTML =response.data[item].wlan_mac_address;
						var td31 = document.createElement("td");
						td31.innerHTML =response.data[item].wlan_ip_address;
						var td32 = document.createElement("td");
						td32.innerHTML =response.data[item].joined_domain;
						var td33 = document.createElement("td");
						td33.innerHTML =response.data[item].connection_type;
						var td34 = document.createElement("td");
						
						
						var td35 = document.createElement("td");
						td35.innerHTML =response.data[item].type_of_purchase;
						
						tr.append(td1);
						tr.append(td2);
						tr.append(td35);
						tr.append(td3);
					
						tr.append(td4);
						tr.append(td5);
						tr.append(td6);
						tr.append(td7);
						tr.append(td8);
						tr.append(td9);
						tr.append(td10);
						tr.append(td11);
						tr.append(td12);
						tr.append(td13);
						tr.append(td14);
						tr.append(td36);
						tr.append(td37);
						tr.append(td15);
						tr.append(td16);
						tr.append(td17);
						tr.append(td18);
						tr.append(td19);
						tr.append(td20);
						tr.append(td21);
						tr.append(td22);
						tr.append(td23);
						tr.append(td24);
						tr.append(td25);
						tr.append(td26);
						tr.append(td27);
						tr.append(td28);
						tr.append(td29);
						tr.append(td30);
						tr.append(td31);
						tr.append(td32);
						tr.append(td33);
						tr.append(td34);
						
					
						$(exportdataTD).append(tr);
						indexarray = indexarray + 1
				}
				
				
				
			
			
				
			}
		});

}

function closeexportdata(){
	document.getElementById("exportdata").style.display = 'none';
}
// Laptop Details
function laptop_graph_Window(){
	$.ajax({
			type: 'Get',
			cache: false,
			url: "{% url 'getlaptopdata' %}",
		
			success: function(response){
				// data type for the graph
				var officepc = [];
				var machinepc = [];
				var Window_98 = [];
				var Window_10 = [];
				var Window_7 = [];
				var Window_xp = [];
				var Window_8 = [];
				var con_intranet = [];
				var con_internet = [];
				var con_offline = [];
				var status_not_inuse = [];
				var status_inuse = [];
				var status_dispose = [];
				var status_pending_dispose = [];
				var status_loan = [];
				// data for the data type
				var data_status = [];
				var data_window = [];
				var data_type = [];
				var data_typeCon = [];

				var data_CD = [];
				var data_USB = [];

				var data_USB_Y = [];
				var data_USB_N = [];

				var data_CD_Y = [];
				var data_CD_N = [];

				for (var item in response.data){
					data_status.push(response.data[item].pccurrentstatus);
					data_window.push(response.data[item].windows);
				
					data_typeCon.push(response.data[item].connection_type);
					data_USB.push(response.data[item].usbunlock);
					data_CD.push(response.data[item].cdunlock);

				}
				
				Window_98 = data_window.filter(function(item) {
			
			return item == 'Windows 98';
			});
			Window_95 = data_window.filter(function(item) {
		
		return item == 'Windows 95';
		});
			var Window_2000 = data_window.filter(function(item) {
			
			return item == 'Windows 2000 Professional';
			});
			var Window_8 = data_window.filter(function(item) {
			
			return item == 'Windows 8.1 Pro 32bit';
			});
			var Window_nt = data_window.filter(function(item) {
			
			return item == 'Windows NT4 workstation';
			});
			Window_10 = data_window.filter(function(item) {
		
			return item == 'Windows 10 Pro 64bit' || item == 'Windows 10 Pro';
			});
			Window_7 = data_window.filter(function(item) {
		
			return item == 'Windows 7 Ultimate' || item == 'Windows 7 Pro 32bit' || item == 'Windows 7 Pro 64bit';
			});
			Window_xp = data_window.filter(function(item) {
			
			return item == 'Windows XP Pro 32bit' || item == 'Windows Vista' ;
			});
			
			status_dispose = data_status.filter(function(item) {
			
			return item == 'Dispose'  ;
			});
			status_pending_dispose = data_status.filter(function(item) {
			
			return item == 'Pending Dispose'  ;
			});
			status_inuse = data_status.filter(function(item) {
			
			return item == 'In-use'  ;
			});
			status_not_inuse = data_status.filter(function(item) {
			
			return item == 'Not in-use'  ;
			});
		
			status_loan = data_status.filter(function(item) {
			
			return item == 'Loan'  ;
			});
			
			con_intranet = data_typeCon.filter(function(item) {
			
			return item == 'Intranet'  ;
			});
			con_internet = data_typeCon.filter(function(item) {
			
			return item == 'Internet' || item == 'Online'  ;
			});
			con_offline = data_typeCon.filter(function(item) {
			
			return item == 'Offline'  ;
			});
			YesUSb = data_USB.filter(function(item) {
			
			return item == 'Yes';
			});

			NoUsb = data_USB.filter(function(item) {
			
			return item == 'No';
			});

			YesCD = data_CD.filter(function(item) {
			
			return item == 'Yes';
			});

			NoCD = data_CD.filter(function(item) {
			
			return item == 'No';
			});
				laptop_detail_graph_window(Window_98, Window_xp, Window_7, Window_10);
				laptop_detail_graph_usage(status_not_inuse, status_inuse, status_pending_dispose, status_dispose, status_loan);
				
				laptop_detail_graph_connection(con_internet, con_intranet, con_offline);
				laptop_detail_graph_USB(YesUSb, NoUsb)
				laptop_detail_graph_CD(YesCD, NoCD)

				
			}
		});

}

function laptop_detail_graph_window(array1, array2, array3, array4){
	var w98 = array1.length;
	var wXP = array2.length;
	var w7 = array3.length;
	var w10 = array4.length;


	const data = {
  labels: [
  'Window 98',
    'Window xp',
    'Windows 7',
    'Windows 10',


  ],
  datasets: [{
    label: 'Type of windows in Computer Details',
    data: [w98, wXP, w7, w10],
    backgroundColor: [
      'rgb(255, 99, 132)',
      'rgb(54, 162, 235)',
      'rgb(255, 205, 86)',
      'rgb(137, 109, 93)',

    ],
    hoverOffset: 4
  }]
};
const config = {
  type: 'doughnut',
  data: data,
};
const myChart = new Chart(
    document.getElementById('windowlaptop'),
    config
  );
}

function laptop_detail_graph_usage(array1, array2, array3, array4, array5){
	var not_use = array1.length;
	var use = array2.length;
	var pending = array3.length;
	var dispose = array4.length;
	var loan = array5.length;



	const data = {
  labels: [
  'Not In-Use',
    'In-use',
    'Loan',
    'Pending Dispose',
    'Dispose',



  ],
  datasets: [{
    label: 'Usage of PC in Computer Details',
    data: [not_use, use, loan, pending, dispose],
    backgroundColor: [
    'rgb(169, 186, 180)',
      'rgb(76, 212, 166)',
      'rgb(236, 242, 46)',
      'rgb(224, 64, 20)',
      'rgb(247, 2, 2)',


    ],
    hoverOffset: 4
  }]
};
const config = {
  type: 'doughnut',
  data: data,
};
const myChart = new Chart(
    document.getElementById('usagelaptop'),
    config
  );
}

function laptop_detail_graph_connection(array1, array2, array3){
	var Internet = array1.length;
	var Intranet = array2.length;
	var Offline = array3.length;




	const data = {
  labels: [
  'Internet',
    'Intranet',
    'Offline'



  ],
  datasets: [{
    label: 'Type of connection in Computer Details',
    data: [Internet, Intranet, Offline],
    backgroundColor: [
      'rgb(255, 99, 132)',
      'rgb(54, 162, 235)',
      'rgb(255, 205, 86)'
      

    ],
    hoverOffset: 4
  }]
};
const config = {
  type: 'doughnut',
  data: data,
};
const myChart = new Chart(
    document.getElementById('conLpatop'),
    config
  );
}

function laptop_detail_graph_USB(array1, array2){
	var data1 = array1.length;
	var data2 = array2.length;





	const data = {
  labels: [
  'Unlock',
    'Block',
  



  ],
  datasets: [{
    label: 'Percentage of USB Block in Laptop Details',
    data: [data1, data2],
    backgroundColor: [
      'rgb(46, 199, 87)',
      'rgb(255, 99, 132)'
      
      

    ],
    hoverOffset: 4
  }]
};
const config = {
  type: 'pie',
  data: data,
};
const myChart = new Chart(
    document.getElementById('USBLaptop'),
    config
  );
}

function laptop_detail_graph_CD(array1, array2){
	var data1 = array1.length;
	var data2 = array2.length;




	const data = {
  labels: [
  'Unlock',
    'Block'



  ],
  datasets: [{
    label: 'Percentage of CD Block in Laptop Details',
    data: [data1, data2],
    backgroundColor: [
	'rgb(46, 199, 87)',
      'rgb(255, 99, 132)'
    

    ],
    hoverOffset: 4
  }]
};
const config = {
  type: 'pie',
  data: data,
};
const myChart = new Chart(
    document.getElementById('CDLaptop'),
    config
  );
}



function Downloadimagedata(){
	xhttp = new XMLHttpRequest();
    xhttp.onreadystatechange = function() {
        var a, today;
        if (xhttp.readyState === 4 && xhttp.status === 200) {
            a = document.createElement('a');
            a.href = window.URL.createObjectURL(xhttp.response);
            today = new Date();
            a.download = "users_" + today.toDateString().split(" ").join("_") + ".pdf";
            a.style.display = 'none';
            document.body.appendChild(a);
            return a.click();
        }
    };
    xhttp.open("GET", "getImagedata", true);
    xhttp.setRequestHeader("Content-Type", "application/json");
    xhttp.responseType = 'blob';
    xhttp.send();

}
</script>
</script>
</body>

</html>